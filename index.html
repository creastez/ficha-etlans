<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Ficha Etlans RPG</title>
<style>
* { margin:0; padding:0; box-sizing:border-box; }
body { font-family: Georgia, serif; background: linear-gradient(135deg, #0a0a0a 0%, #1a0f0f 100%); color: #d4af37; min-height: 100vh; padding: 20px; }
.container { max-width: 1400px; margin: 0 auto; }
.menu { display: none; text-align: center; }
.menu.active { display: block; }
.menu h1 { font-size: 3.5em; margin: 40px 0; color: #d4af37; text-shadow: 4px 4px 8px rgba(0,0,0,0.8); letter-spacing: 2px; }
.btn { background: #6b4423; border: 1px solid #8b4513; color: #d4af37; padding: 12px 24px; cursor: pointer; border-radius: 4px; margin: 8px; font-size: 1em; transition: all 0.3s; font-family: Georgia, serif; }
.btn:hover { background: #8b5a2b; box-shadow: 0 0 15px rgba(212,175,55,0.4); }
.btn-add { background: #3a6b3a; }
.btn-add:hover { background: #4a8b4a; }
.btn-remove { background: #8b3a3a; }
.btn-remove:hover { background: #a04a4a; }
.char-list { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 20px; margin: 30px 0; }
.char-card { background: linear-gradient(135deg, #2a1810 0%, #1a0f0a 100%); border: 2px solid #8b4513; border-radius: 8px; padding: 20px; box-shadow: 0 4px 10px rgba(0,0,0,0.5); }
.char-card:hover { border-color: #d4af37; box-shadow: 0 0 20px rgba(212,175,55,0.3); }
.char-card h3 { color: #d4af37; margin-bottom: 15px; }
.char-actions { display: flex; gap: 10px; margin-top: 15px; flex-wrap: wrap; }
.char-actions button { flex: 1; }
.blk { background: linear-gradient(135deg, #1a1a1a 0%, #0f0f0f 100%); border: 1px solid #8b4513; border-radius: 6px; padding: 20px; margin: 20px 0; box-shadow: 0 2px 8px rgba(0,0,0,0.4); }
.blk h2 { color: #d4af37; font-size: 1.3em; margin-bottom: 15px; border-bottom: 2px solid #6b4423; padding-bottom: 10px; text-transform: uppercase; letter-spacing: 1px; }
.fld { display: flex; flex-direction: column; margin: 12px 0; }
.fld label { color: #a0826d; text-transform: uppercase; margin-bottom: 5px; font-size: 0.85em; font-weight: bold; }
.fld input, .fld textarea { background: #0a0a0a; border: 1px solid #6b4423; color: #d4af37; padding: 8px; border-radius: 3px; }
.fld textarea { resize: vertical; min-height: 80px; }
.grd2 { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
@media (max-width: 1200px) { .grd2 { grid-template-columns: 1fr; } }
.row { display: grid; grid-template-columns: repeat(auto-fit, minmax(100px, 1fr)); gap: 12px; }
.chk { display: flex; align-items: center; padding: 8px; background: rgba(0,0,0,0.3); border-radius: 4px; }
.chk input { margin-right: 12px; cursor: pointer; width: 18px; height: 18px; }
.chk label { cursor: pointer; margin: 0; flex: 1; }
.tbl { width: 100%; border-collapse: collapse; margin-top: 10px; }
.tbl th, .tbl td { padding: 10px; text-align: left; border-bottom: 1px solid #6b4423; }
.tbl th { background: #0a0a0a; color: #a0826d; font-weight: bold; text-transform: uppercase; }
.sm-btn { padding: 4px 8px; font-size: 0.8em; }
.mdl { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 1000; align-items: center; justify-content: center; }
.mdl.active { display: flex; }
.mdl-cnt { background: linear-gradient(135deg, #2a1810 0%, #1a0f0a 100%); border: 2px solid #8b4513; border-radius: 8px; padding: 30px; max-width: 600px; width: 90%; }
.mdl-cnt h2 { color: #d4af37; margin-bottom: 20px; }
.hdr { background: linear-gradient(135deg, #2a1810 0%, #1a0f0a 100%); border: 2px solid #8b4513; border-radius: 8px; padding: 25px; margin: 20px 0; }
.hdr h1 { color: #d4af37; font-size: 2.5em; margin-bottom: 15px; }
.tbr { display: flex; justify-content: space-between; align-items: center; margin: 20px 0; flex-wrap: wrap; gap: 10px; }
.tbr h2 { color: #d4af37; margin: 0; }
</style>
</head>
<body>

<div id="menuScreen" class="menu active">
<div class="container">
<h1>ETLANS RPG</h1>
<p style="color: #a0826d; font-size: 1.2em; margin: 20px 0 40px 0;">Sistema de Fichas</p>
<button class="btn" onclick="showCreateModal()">Criar Novo Personagem</button>
<button class="btn" onclick="showSettings()">Configuracoes</button>
<div class="char-list" id="charList"></div>
</div>
</div>

<div id="sheetScreen" style="display:none;">
<div class="container">
<div class="tbr">
<button class="btn" onclick="backMenu()">Voltar</button>
<h2 id="charTitle">Ficha</h2>
<button class="btn" onclick="showSettings()">Configuracoes</button>
</div>

<div class="hdr">
<h1>FICHA DE PERSONAGEM</h1>
<div style="display: grid; grid-template-columns: 1fr 1fr 1fr 1fr; gap: 15px; margin-top: 15px;">
<div class="fld"><label>Nome</label><input type="text" id="name" onchange="save()"></div>
<div class="fld"><label>Jogador</label><input type="text" id="player" onchange="save()"></div>
<div class="fld"><label>Historico</label><input type="text" id="historico" onchange="save()"></div>
<div class="fld"><label>Arquetipo</label><input type="text" id="arquetipo" onchange="save()"></div>
</div>
</div>

<div class="grd2">
<div class="blk">
<h2>ATRIBUTOS FISICOS</h2>
<div class="row">
<div class="fld"><label>FOR</label><input type="number" id="FOR" min="0" onchange="save()"></div>
<div class="fld"><label>DES</label><input type="number" id="DES" min="0" onchange="save()"></div>
<div class="fld"><label>VIG</label><input type="number" id="VIG" min="0" onchange="save()"></div>
</div>
<h2 style="margin-top:20px;">ATRIBUTOS SOCIAIS</h2>
<div class="row">
<div class="fld"><label>PRE</label><input type="number" id="PRE" min="0" onchange="save()"></div>
<div class="fld"><label>INT</label><input type="number" id="INT" min="0" onchange="save()"></div>
<div class="fld"><label>MAN</label><input type="number" id="MAN" min="0" onchange="save()"></div>
</div>
<h2 style="margin-top:20px;">ATRIBUTOS MENTAIS</h2>
<div class="row">
<div class="fld"><label>SEN</label><input type="number" id="SEN" min="0" onchange="save()"></div>
<div class="fld"><label>VON</label><input type="number" id="VON" min="0" onchange="save()"></div>
<div class="fld"><label>RES</label><input type="number" id="RES" min="0" onchange="save()"></div>
</div>
</div>

<div class="blk">
<h2>RECURSOS</h2>
<div class="row">
<div class="fld"><label>Vida (PV)</label><input type="number" id="pv" min="0" onchange="save()"></div>
<div class="fld"><label>Foco (PF)</label><input type="number" id="pf" min="0" onchange="save()"></div>
<div class="fld"><label>Energia (PE)</label><input type="number" id="pe" min="0" onchange="save()"></div>
<div class="fld"><label>Movimento</label><input type="number" id="pm" min="0" onchange="save()"></div>
<div class="fld"><label>Armadura</label><input type="number" id="armor" min="0" onchange="save()"></div>
<div class="fld"><label>Proficiencias</label><input type="text" id="proficiencias" onchange="save()"></div>
</div>
</div>
</div>

<div class="blk">
<h2>PERICIAS</h2>
<div class="row" style="grid-template-columns: repeat(3, 1fr);">
<div class="fld"><label>Academicos</label><input type="number" id="pAcad" min="0" onchange="save()"></div>
<div class="fld"><label>Arma Dist</label><input type="number" id="pArmaDist" min="0" onchange="save()"></div>
<div class="fld"><label>Arma Branca</label><input type="number" id="pArmaBr" min="0" onchange="save()"></div>
<div class="fld"><label>Atletismo</label><input type="number" id="pAtle" min="0" onchange="save()"></div>
<div class="fld"><label>Escala</label><input type="number" id="pEsc" min="0" onchange="save()"></div>
<div class="fld"><label>Enganacao</label><input type="number" id="pEng" min="0" onchange="save()"></div>
<div class="fld"><label>Intuicao</label><input type="number" id="pInt" min="0" onchange="save()"></div>
<div class="fld"><label>Luta</label><input type="number" id="pLuta" min="0" onchange="save()"></div>
<div class="fld"><label>Medicina</label><input type="number" id="pMed" min="0" onchange="save()"></div>
<div class="fld"><label>Ocultismo</label><input type="number" id="pOcul" min="0" onchange="save()"></div>
<div class="fld"><label>Profissao</label><input type="number" id="pProf" min="0" onchange="save()"></div>
<div class="fld"><label>Reflexos</label><input type="number" id="pRef" min="0" onchange="save()"></div>
</div>
</div>

<div class="blk">
<h2>COMBATE</h2>
<div class="fld"><label>Arma</label><input type="text" id="cbArma" onchange="save()"></div>
<div class="fld"><label>Dano</label><input type="text" id="cbDano" onchange="save()"></div>
<div class="fld"><label>Critico</label><input type="text" id="cbCrit" onchange="save()"></div>
<div class="fld"><label>Distancia</label><input type="text" id="cbDist" onchange="save()"></div>
<div class="fld"><label>Tipo</label><input type="text" id="cbTipo" onchange="save()"></div>
<div class="fld"><label>Peso</label><input type="text" id="cbPeso" onchange="save()"></div>
</div>

<div class="blk">
<h2>HABILIDADES ETLANS</h2>
<button class="btn btn-add" onclick="addHab()">+ Habilidade</button>
<div id="habList"></div>
</div>

<div class="blk">
<h2>INVENTARIO</h2>
<button class="btn btn-add" onclick="addInv()">+ Item</button>
<table class="tbl" id="invTable"></table>
</div>

<div class="blk">
<h2>EFEITOS NEGATIVOS</h2>
<button class="btn btn-add" onclick="addEfeit()">+ Efeito</button>
<div id="efeitList" class="chk"></div>
</div>

<div class="blk">
<h2>HISTORICO & ANOTACOES</h2>
<div class="fld"><label>Historico Pessoal</label><textarea id="hist" onchange="save()"></textarea></div>
<div class="fld"><label>Anotacoes</label><textarea id="notas" onchange="save()"></textarea></div>
</div>

</div>
</div>

<div id="createMdl" class="mdl">
<div class="mdl-cnt">
<h2>Criar Novo Personagem</h2>
<div class="fld"><label>Nome</label><input type="text" id="newCharName" placeholder="Digite o nome"></div>
<button class="btn" onclick="create()">Criar</button>
<button class="btn" onclick="closeMdl()">Cancelar</button>
</div>
</div>

<div id="setMdl" class="mdl">
<div class="mdl-cnt">
<h2>Configuracoes</h2>
<button class="btn" onclick="exportChar()">Exportar Ficha</button>
<button class="btn" onclick="tglImp()">Importar Ficha</button>
<button class="btn" onclick="reset()">Resetar Tudo</button>
<div id="impDiv" style="display:none; margin-top:15px;">
<textarea id="impText" placeholder="Cole JSON aqui" style="width:100%; height:150px; background:#0a0a0a; border:1px solid #6b4423; color:#d4af37; padding:10px; border-radius:3px;"></textarea>
<button class="btn" onclick="importChar()">Importar</button>
</div>
<button class="btn" onclick="closeMdl()">Fechar</button>
</div>
</div>

<script>
let chars = [], curId = null;

function save() {
  if (!curId) return;
  let form = document.getElementById('charForm');
  let fd = new FormData(form);
  let data = {};
  data['name'] = fd.get('name');
  data['classe'] = fd.get('classe');
  data['raca'] = fd.get('raca');
  
  let attrs = ['forca', 'destreza', 'constituicao', 'inteligencia', 'sabedoria', 'carisma'];
  for (let a of attrs) data[a] = fd.get(a) || 0;
  
  data['pv'] = fd.get('pv') || 0;
  data['pf'] = fd.get('pf') || 0;
  data['pe'] = fd.get('pe') || 0;
  data['movimento'] = fd.get('movimento') || 0;
  data['armadura'] = fd.get('armadura') || 0;
  data['proficiencias'] = fd.get('proficiencias') || '';
  
  data['pericias'] = {};
  let pericias = ['acrobacias', 'adestramento', 'arcana', 'atletismo', 'atuacao', 'ciencia', 'deceptacao', 'destresa', 'enganacao', 'esperteza', 'espiritismo', 'esvaziamento', 'historia', 'humildade', 'intuicao', 'investigacao', 'luta', 'magia', 'medicamento', 'meditacao', 'memoria', 'natureza', 'obvservacao', 'ocultismo', 'oficio', 'persuasao', 'pilotagem', 'religiao', 'roubo', 'sinceridade', 'sobrevivencia', 'vontade'];
  for (let p of pericias) data['pericias'][p] = fd.get('per_' + p) || 0;
  
  data['efeitos'] = fd.get('efeitos') || '';
  data['historico'] = fd.get('historico') || '';
  data['anotacoes'] = fd.get('anotacoes') || '';
  
  let c = chars.find(x => x.id == curId);
  if (c) Object.assign(c, data);
  localStorage.setItem('etlans', JSON.stringify(chars));
  alert('Ficha salva!');
}

function loadChar(id) {
  curId = id;
  let c = chars.find(x => x.id == id);
  if (!c) return;
  
  document.getElementById('menu').classList.remove('active');
  document.getElementById('sheet').classList.add('active');
  
  document.getElementById('charName').textContent = c.name || 'Sem nome';
  document.getElementById('charForm').style.display = 'block';
  
  let form = document.getElementById('charForm');
  form.reset();
  form.nome.value = c.name || '';
  form.classe.value = c.classe || '';
  form.raca.value = c.raca || '';
  
  let attrs = ['forca', 'destreza', 'constituicao', 'inteligencia', 'sabedoria', 'carisma'];
  for (let a of attrs) form[a].value = c[a] || 0;
  
  form.pv.value = c.pv || 0;
  form.pf.value = c.pf || 0;
  form.pe.value = c.pe || 0;
  form.movimento.value = c.movimento || 0;
  form.armadura.value = c.armadura || 0;
  form.proficiencias.value = c.proficiencias || '';
  form.efeitos.value = c.efeitos || '';
  form.historico.value = c.historico || '';
  form.anotacoes.value = c.anotacoes || '';
  
  if (c.pericias) {
    for (let p in c.pericias) {
      let el = form['per_' + p];
      if (el) el.value = c.pericias[p];
    }
  }
}

function create() {
  let name = document.getElementById('newCharName').value;
  if (!name) { alert('Digite um nome'); return; }
  let id = Date.now();
  let newChar = { id: id, name: name, classe: '', raca: '', pericias: {} };
  chars.push(newChar);
  localStorage.setItem('etlans', JSON.stringify(chars));
  loadChar(id);
  document.getElementById('newCharName').value = '';
}

function closeChar() {
  curId = null;
  document.getElementById('charForm').style.display = 'none';
  document.getElementById('menu').classList.add('active');
  document.getElementById('sheet').classList.remove('active');
  renderList();
}

function delChar(id) {
  if (!confirm('Apagar?')) return;
  chars = chars.filter(x => x.id != id);
  localStorage.setItem('etlans', JSON.stringify(chars));
  closeChar();
}

function renderList() {
  let list = document.getElementById('charList');
  list.innerHTML = '';
  for (let c of chars) {
    let div = document.createElement('div');
    div.className = 'char-card';
    div.innerHTML = '<h3>' + c.name + '</h3><p>' + (c.classe || 'Sem classe') + '</p>';
    let btns = document.createElement('div');
    btns.className = 'char-actions';
    btns.innerHTML = '<button class="btn" onclick="loadChar(' + c.id + ')">Abrir</button><button class="btn btn-remove" onclick="delChar(' + c.id + ')">Apagar</button>';
    div.appendChild(btns);
    list.appendChild(div);
  }
}

function exportChar() {
  if (!curId) return;
  let c = chars.find(x => x.id == curId);
  let json = JSON.stringify(c, null, 2);
  let blob = new Blob([json], {type: 'application/json'});
  let url = URL.createObjectURL(blob);
  let a = document.createElement('a');
  a.href = url;
  a.download = (c.name || 'ficha') + '.json';
  a.click();
}

function importChar() {
  let input = document.getElementById('impText');
  try {
    let data = JSON.parse(input.value);
    data.id = Date.now();
    chars.push(data);
    localStorage.setItem('etlans', JSON.stringify(chars));
    input.value = '';
    alert('Importado!');
    renderList();
  } catch (e) {
    alert('JSON inv√°lido');
  }
}

function reset() {
  if (!confirm('Limpar tudo?')) return;
  chars = [];
  localStorage.setItem('etlans', JSON.stringify(chars));
  closeChar();
}

window.addEventListener('load', function() {
  let stored = localStorage.getItem('etlans');
  chars = stored ? JSON.parse(stored) : [];
  renderList();
});
</script>
  </body>
</html>
